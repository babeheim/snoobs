\documentclass[11pt]{article}
\usepackage{natbib} % our bibliography system 
\usepackage{graphicx} % allows graphics
\usepackage{hyperref} % for adding color and clickable links to references

% configuration of {hyperref} package
\hypersetup{
  colorlinks=true,
  linkcolor=blue,
  citecolor=blue,
  urlcolor=blue
}

\usepackage{amsmath} % allows numbered equations, for one thing
\usepackage{authblk} % to add more authors

\usepackage[a4paper, total={6in, 8in}]{geometry}

\usepackage[dvipsnames]{xcolor} % adds 68 named colors and the ability to define your own, but can cause trouble with beamer and tikz; tikz must be declared after this

\usepackage{mathpazo} % URW Palladio, from Palatino
\usepackage{microtype} % cleans up the kerning and hypenation
\usepackage[margin=15pt,font=small,labelfont={bf,sf}]{caption} % cleans up the structure of the captions

\usepackage{titlesec} % formatting titles
% qpl - TeX Gyre Pagella
\titleformat{\section}
  {\normalfont\fontfamily{qpl}\fontsize{16}{19}\selectfont\scshape}{\thesection}{1em}{}
\titleformat{\subsection}
  {\normalfont\fontfamily{qpl}\fontsize{14}{17}\selectfont\scshape}{\thesubsection}{1em}{}
\titleformat{\subsubsection}
  {\normalfont\fontfamily{qpl}\fontsize{14}{17}\selectfont\scshape}{\thesubsubsection}{1em}{}




\title{Evolutionary Decomposition and the Mechanisms of Cultural Change}
\author[,    1]{Bret A. Beheim\footnote{Corresponding author; beheim@gmail.com.}}
\author[1]{Ryan Baldini}
\affil[1]{Graduate Group in Ecology, Department of Environmental Science and Policy, University of California, Davis, USA}
\date{31 March 2012}


\begin{document}

\maketitle

\setlength{\parindent}{30pt}

\section{Introduction}

For the last half-century, many anthropologists and evolutionary biologists have independently realized the fundamental connection between evolutionary theory and cultural change \citep{campbell1965variation, cavallisforza1981cultural, boyd1985culture, durham1992coevolution, lumsden2005genes, dawkins2006selfish}. Recent decades have witnessed a proliferation of theory regarding the evolution of cultural capacities and traits in humans. Most theorists suppose that culture can be fruitfully studied by imagining it as a set of ``cultural traits," representing socially-learned beliefs and behaviors held by individuals. Cultural evolution, analogous to genetic evolution, occurs when the distribution of these traits changes over time. And as in genetic evolution, we can use mathematical modeling to study the evolutionary mechanisms driving cultural systems. Following this approach, theorists study how natural selection might favor various capacities for social learning, and how these adaptations in turn affect the evolution of behavior and material technology in a population. 

The hypotheses produced by this large theoretical literature have received relatively modest empirical testing, and most of that in controlled, experimental contexts. Many studies have compared the behavior of subjects in multi-armed bandit or cooperation games to models of various social learning strategies \citep{mcelreath2005applying, efferson2007learning, efferson2008conformists, mcelreath2008beyond, mesoudi2008cultural, eriksson2009people, rendell2011copying}. Other task experiments have progressively removed and replaced participants to create multi-generational ``micro-societies" that mimic the development of cultural or technological traditions \citep{baum2004cultural, caldwell2008studying}.  These experiments reveal how various game conditions affect how players learn from others, and how they transmit information through time and space.

As is always the case with experimental studies, it is difficult to evaluate the external validity of this results of these studies.  With a few exceptions \citep{paciotti2003ultimatum, efferson2007learning, chudek2011prestige}, most such experiments use university students, a highly unusual human subgroup \citep{henrich2010weirdest}. Naturalistic studies of real-world cultural phenomena provide a remedy, but quantitative studies of this kind are rare. Most have successfully tested ``static" hypotheses, investigating how ecological and ethnic contexts predict the distribution of cultural beliefs and behaviors at a single point in time \citep{paciotti2003ultimatum, mcelreath2004social, henrich2010evolution, henrich2011nature}. Absent high-resolution longitudinal data, researchers in this theoretical vein can rarely observe cultural change in real-time \citep{gravlee2009methods}. Surely this is due, in part, to the time costs of acquiring such data; evolutionary processes, even cultural ones, are usually long-term and large-scale. Panel studies and historical records provide the most promising avenue for analysis of modern cultural evolution, and in coming years, large-scale data collection and digitization projects will allow access to massive datasets of unprecedented resolution (e.g.~\citealp{michel2011quantitative}).

One major problem facing researchers of cultural evolution is the lack of a principled, quantitative method that can make sense of long-term trends in high-resolution datasets. Consequently, we do not have a firm understanding of how the simplest demographic and evolutionary processes (e.g. differential fertility, survival, individual learning) shape the relative abundance of particular ideas, behaviors or use of technologies.  The best example we know of that analyzes long-term cultural change in an implicitly evolutionary framework is \cite{hout2001demographic} study of the fertility advantages enjoyed by conservative Protestants in the US over the course of the twentieth century. Such demographic work reminds us that the history of a cultural trait is shaped not only by the spread of information from person to person, but also differential migration, birth and death rates.

We argue here that an evolutionary-demographic approach, similar to Hout et al.'s, is the right one for general analyses of cultural evolution. Following the recent work of evolutionary demographers \citep{coulson2008dynamics, ozgul2009dynamics}, we present an equation that decomposes the evolution of any mean character into the contributions of various demographic processes - namely, reproductive success, parent-offspring transmission, death, immigration, individual change, and emigration. We assert that the aggregate of these processes completely describes all evolutionary change; hence, our method provides an exact description of evolution in a cultural system.  With sufficient data, the method may reveal which processes have contributed most to the evolution of any character, which are relatively unimportant, and which ``directions" these processes tend to push.

Our argument proceeds as follows: first, we show mathematically that any change in the mean phenotype of a population of organisms can be decomposed exactly into terms corresponding to standard demographic processes, and argue that these pieces have meaningful evolutionary interpretations. We then decompose the trajectory of a cultural trait from simulated field data into the terms of our equation, which tells us the relative importance of reproductive success, inheritance, death, migration, and individual change to the long term evolution of a hypothetical cultural trait.  Decomposition patterns can also help us model mechanisms underlying a cultural trend, which we demonstrate by fitting various demographic and learning models to the field data to draw tentative conclusions about the major mechanisms underlying the observed cultural evolution.  

\section{The RTDICE Decomposition}

Between any two census times $t$ and $t+1$, the growth of a population of organisms can be calculated using the famous demographer's equation,
\begin{equation} \label{eq:demo}
\Delta N = B - D + I - E
\end{equation}
which decomposes the observed change in population size into four measurable flux quantities, representing the number of births, deaths, immigrants and emigrants, respectively.  Note that although each term clearly represents a distinct demographic process, we cannot consider them strictly in isolation; had the births been greater, the deaths would undoubtedly be different, and so forth.  Moreover, in many realistic situations we can only register deaths among those who had been alive at time $t$, leaving some intercensus events completely inaccessible.  Nevertheless, this decomposition equation gives a clear sense of both \textit{how much} the population is changing and, to some extent, \textit{why}.  Population growth due to births is different than growth through immigration by the same amount, and distinguishing between them is vital.  Our analysis begins by asking whether a similar decomposition can be done for the evolutionary trajectory of a phenotypic trait measured on the population.

In observing evolution, we require that within each census, each individual $i$ possesses some observable phenotypic value, $\phi_i$.  This may represent their ethnicity, age, height, athletic ability, income, religion, occupation, number of livestock owned, political opinions, consumer preferences, or any other quantifiable trait whose population properties we care to track.  Since we leave the phenotype unspecified, this analysis applies to any species of organism, though we will focus here on tracking human phenotypic trajectories.  Given this goal, we seek a decomposition equation for the intercensus change in the \textit{mean phenotype} of the population, $\overline{\phi}$, analogous to equation \ref{eq:demo}.  Below we present the derivation for one such equation, the RTDICE decomposition.\footnote{RTDICE stands for ``reproduction, transmission, death, immigration, change, emigration,'' six categories that capture all evolution on the phenotypic distribution.  Here ``change'' means intercensus phenotypic change within individuals.}

For the purpose of exposition, imagine we sum the phenotypic value of every individual in a population at a particular time, such that $\phi = \sum \phi_i$.  We take it as self-evident that this aggregate value can change in only five ways: births and immigrants add their phenotypes, emigrants and deaths subtract theirs, and individuals who remain in the population may change their phenotype between the two periods.\footnote{To be precise, in our analysis all individuals who join the population between time period $t$ and $t+1$ are classified as ``births'' if both their parents were in the population in time $t$, and otherwise are ``immigrants.''  All individuals who were present in the population at time $t$ and left it before $t+1$ are either deaths or emigrants depending on how they left.  With only periodic census data, individuals who both joined and left the population intercensus are invisible to our analysis.}  Thus the aggregate phenotype at the next census, $\phi'$, is given by
  \[\phi' = \phi + \phi_B - \phi_D  + \phi_I + \rho - \phi_E, 
\]
where $\phi_B$ is the sum of phenotypes of intercensus births (as measured at $t+1$), $\phi_D$ of intercensus deaths (using their phenotypes at time $t$), and likewise for immigrants and emigrants.  For those who survived from $t$ to $t+1$, $\rho$ is the sum of the differences between their phenotypes at the two times.  Using equation \ref{eq:demo}, we can express the population growth ratio (or finite rate of increase) as 
  \[G = N'/N  = 1 + b - d + i - e
\]
where $b=B/N$ is the births between $t$ and $t+1$ per member of the population in time $t$, and so forth for $d$, $i$, and $e$.  Thus, we can write the change in the mean phenotype of the population, $\Delta \overline{\phi} = \overline{\phi}' - \overline{\phi}$, as
  \[\Delta \overline{\phi} = \frac{1}{G}\left(\overline{\phi} + b\overline{\phi}_B - d\overline{\phi}_D + i\overline{\phi}_I + c\overline{\rho} - e\overline{\phi}_E - \overline{\phi}(1 + b - d + i - e)\right).
\]
Let $c=1-d-e$ represent proportion of the population from time $t$ remaining at time $t+1$.  Note that the term $\overline{\phi}_B= \phi_B/B$ represents the mean phenotype among births, $\overline{\phi}_D$ among deaths, and so on.  Rearranging and simplifying gives 
\begin{equation} \label{eq:BDICE}
G \Delta \overline{\phi} =  b(\overline{\phi}_B - \overline{\phi}) - d(\overline{\phi}_D - \overline{\phi}) + i(\overline{\phi}_I - \overline{\phi}) + c \overline{\rho} - e(\overline{\phi}_E - \overline{\phi}).
\end{equation}

Equation \ref{eq:BDICE} decomposes mean phenotypic change as the demographer's equation does for population change.  The first term on the right, $b(\overline{\phi}_B - \overline{\phi})$, can be thought of as the effect of births on mean phenotype, the next term, deaths, then immigration, individual change, and emigration, respectively.  Like the left side of the equation, each term on the right is a product of a rate per capita and a difference.  When applied to census data, equation \ref{eq:BDICE} allows us to see how births, deaths, migration and individual change separately\footnote{As in the demographer's equation, some intercensus events are often unknown, so these terms are not truly ``independent" in any real population. We clarify this point in the Discussion.} affect the trajectory of mean phenotype.  

Provided parent-offspring relationships are known, we can further decompose the birth term in equation \ref{eq:BDICE} to distinguish the effect of differential reproductive success of the parents (RS) from the deviation of the child phenotype (transmission bias).  To be specific, the term $\overline{\phi}_B$ can be calculated either by dividing the aggregate of offspring phenotypes by the number of offspring, or expressed using parent phenotypes and a transmission bias term.  If $\delta_k$ represents the difference between the phenotype of each child $k$ and the average phenotype of its parents, then the mean phenotype of births is
  \[\overline{\phi}_B = \frac{1}{bN} \sum^N \frac{f_i}{2} \phi_i + \frac{1}{B} \sum^B \delta_k = \overline{\phi}_{R} + \overline{\delta}.
\]
where $f_i$ is the number of offspring of individual $i$.\footnote{The division by two is necessary for offspring with two parents.}  The term $\overline{\phi}_{R}$ weights parent phenotypes by their reproductive output, while $\overline{\delta}$ captures the difference between offspring and their midparents, on the average.  This distinction provides us the full RTDICE evolutionary decomposition,
\begin{equation}  \label{eq:RTDICE}
G\Delta \overline{\phi} = b(\overline{\phi}_{R} - \overline{\phi}) + b \overline{\delta} - d(\overline{\phi}_D - \overline{\phi}) + i(\overline{\phi}_I - \overline{\phi}) + c \overline{\rho} - e(\overline{\phi}_E - \overline{\phi}).
\end{equation}

As before, the six right-side terms of equation \ref{eq:RTDICE} decompose the change in mean phenotype into the contributions of differential reproductive success, transmission bias, death, immigration, individual change, and emigration, respectively. 

It is worth recognizing that most of the terms in equation \ref{eq:RTDICE} can be expressed as covariances (e.g. $d(\overline{\phi}_D - \overline{\phi}) = \mathrm{cov}(d,\phi)$).  This fact immediately reveals the conceptual connection between our demographic decomposition of evolution and the Price equation \citep{price1970selection}.\footnote{Price's famous theorem shows that, in the notation used above, $G \Delta \overline{\phi} = \mathrm{cov}(w, \phi) + G\overline{\delta}$, where $w$ gives the total number of ``descendants'' produced by an individual.  This is the first and most general evolutionary decomposition equation, and is the starting place for what Sean Rice calls the ``algebra of evolution'' \citep{rice2004evolutionary}. If we ignore migration and treat surviving individuals as their own descendants, we recover Price's theorem from our equation \ref{eq:RTDICE}.}

Equation \ref{eq:RTDICE} is true for any measurable character for any population of a sexually reproducing species (and is easily modified for asexual or unisex populations), and provides insight into the nature of the evolutionary forces at work.  A large magnitude RS term, for example, may indicate the operation of fecundity or sexual selection.  The mortality term could be large or small due to viability selection on the phenotype's distribution.  In a genetic context, transmission bias may indicate mutation or meiotic drive, while individual change gives us knowledge of the role of ontogeny.  For culturally-transmitted phenotypes, both the transmission bias and individual change terms may indicate the presence of learning biases.  Emigration and immigration have less connection to Darwinian forces, but may indicate the importance of dispersal or source-sink effects.  In short, provided we have individual-level data, we can use evolutionary decomposition to profile important trends within data straight away (Table \ref{tab:DemoData} \& \ref{tab:DemoDecomp}).  

    \begin{table}[htbp]
    \begin{center}
    \begin{footnotesize}
    \begin{tabular}{cccc}
    \hline
    \hline
    ID    & Census 1 $\phi_i$ & Census 2 $\phi_i$ & Parents \\
    \hline
    Edward & 1     & \textit{emigrated} &  \\
    Lyn   & 0     & \textit{died}  &  \\
    Pat   & 1     & 0     &  \\
    Susan & 1     & 0     &  \\
    Bob   & 0     & 0     &  \\
    Alex      &   & 1     & Edward, Lyn \\
    Jeff      &   & 0     & Edward, Susan \\
    Mike      &    & 0     & Bob, Pat \\
    Andrew      &  & 1     & (\textit{immigrant})\\
    Ian      &     & 1     & Edward, Susan \\
    \hline
    Mean Phenotype: & 0.6 & 0.375 & \\
    \hline
    
     \end{tabular}
    \caption{A hypothetical dataset with individual-level census data for two time periods, measuring a binary phenotype $\phi_i$ (note that $\phi_i$ can be discrete or continuous in this analysis).  Jeff, Mike, and Ian are born intercensus.  Provided we can identify individuals across multiple time periods and also establish parentage, we can apply equation \ref{eq:RTDICE} to calculate the decomposition terms for the change in mean phenotype in the population (Table 2).}
    \label{tab:DemoData}
    \end{footnotesize}
    \end{center}
    \end{table}


  \begin{table}[htbp]
  \begin{footnotesize}
  \begin{center}
  \begin{tabular}{lrr}
    
  \textit{Term from equation \ref{eq:RTDICE}} & \textit{Effect} & \textit{Calculation}\\
  \hline
  Reproductive Success & 0.12  &  $b(\overline{\phi}_{R} - \overline{\phi})$ \\
  Transmission Bias & -0.20  &  $b\overline{\delta}$ \\
  Death & 0.12  &  $-d(\overline{\phi}_D - \overline{\phi})$ \\
  Immigration & 0.08  &  $i(\overline{\phi}_I - \overline{\phi})$\\
  Individual Change &  -0.40  &  $c\overline{\rho}$ \\
  Emigration & -0.08  &  $-e(\overline{\phi}_E - \overline{\phi})$\\
  \hline
  Weighted Mean Change & $1.6 \times -0.225$ &  $G \Delta \overline{\phi}$\\
  
  \end{tabular}%
  \caption{Feeding the data from table 1 into equation \ref{eq:RTDICE}, we decompose the evolutionary change of -0.225 into the six terms on the right in the above table.  Emigration and immigration effectively cancel each other out, and though individuals with a phenotype value of 1 had more children (positive RS term) and died less (positive mortality term), this is more than offset by the fact their children tend to be phenotype 0's (negative transmission bias).  That, coupled with a unanimous change to phenotype 0 among the three survivors from time $t$, causes the population mean to decrease by 22.5 percentage points.  Because the decomposed terms \textit{must} sum to the observed change under all circumstances, we can ensure the calculations are correct.}
  \label{tab:DemoDecomp}
  \end{center}
  \end{footnotesize}
  \end{table}%
  
  
\section{An Island Simulation: The Rise of Snoobism}

One application of this decomposition analysis is assessing the practical importance of different evolutionary forces. In human cultural evolution, researchers often discuss how beliefs and behaviors can successfully diffuse in multiple ways; vertically, through stable inheritance from parents to offspring, or horizontally/obliquely within a social network \citep{richerson2005not}.  As such, when viewing the prevalence of a particular trait over time, we wish to know exactly how much of its trajectory can be attributed to the relative reproductive success of its practitioners, how much to relative horizontal or oblique adoption, and how much to relative migration (e.g.~\citealp{stark1996rise, hout2001demographic}).  Because contrasting evolutionary forces enter equation \ref{eq:RTDICE} through different terms, we can directly and precisely compare their relative consequences if we have the right data.  

To demonstrate the utility of evolutionary decomposition in profiling important trends in cultural change, we analyze census data generated by an agent-based simulator in the \texttt{R} language, \texttt{SnoobSim}.  Simulations can easily descend into unrealistic omniscience in a virtual world of contrived assumptions.  To avoid this problem, we proceed with two rules: first, everything in the analyzed data must be realistic for researchers to collect in the field, and second, the conclusions drawn must rest purely on the recorded dataset itself, rather than the algorithms that produced the data.  As in real life, the goal is to establish exactly how far we can get without knowing the ``rules'' of the system; it is a feature of our analysis that we can gain much new knowledge about the evolutionary processes behind observed dynamics without knowing their true nature.  

In our simulation, a population of around 1,000 humans arrives in a resource-rich environment akin to Hawaii or New Zealand, and begins growing according to realistic daily mortality and reproduction schedules.\footnote{Individuals within the population reproduce, age and die at age-specific rates comparable to real human populations.  For the technical details of the simulator processes, see the ESM.  The census dataset analyzed here, and R code for \texttt{SnoobSim} are available on the authors' websites.}  Every five years, a full census of the population is collected, recording names, parentage, age, and several phenotypic measures.  After 270 years, the population now numbers about 8,000 individuals and 54 such record tables have been collected, allowing us an extraordinarily high-resolution picture of the population's evolution.

Among the settlers, a minority group adheres to a culturally-transmitted worldview we call Snoobism.  Among other aspects of the belief system, Snoob norms celebrate marrying other Snoobs, having large families of Snoob children, and living a safe, healthy and frugal Snoob lifestyle.  Purely for simplicity, we treat this as a discrete, binary trait individuals may acquire or lose in the course of their lifetimes.  Encompassing around a fifth of the original settlers, Snoobism spreads to nearly every member of the population by the final census, twelve generations later.  

Following \cite{ozgul2009dynamics}, we contend that evolutionary decomposition can provide a uniquely straightforward understanding of this trend.  If we plug the records of each of the 54 censuses into the RTDICE equation, we produce decomposition terms for each of the 53 values of $\Delta \overline{\phi}$, as in Table \ref{tab:DemoDecomp}.  This information is collected and organized in Figure \ref{fig:Snoob}.

\begin{figure}[t]
\begin{center} 
\includegraphics[scale=0.4]{assets/FigSnoobCol.pdf}
\caption{(a) The population frequency of a binary cultural trait, Snoobism, observed over time, superimposed with the nonzero decomposition terms from the RTDICE equation.  Bars stacked above the Snoob frequency line represent positive magnitudes, and stacked below it, negative.  Since each bar represents one of the terms of equation \ref{eq:RTDICE} (divided by $G$), their sum steers the direction of the frequency line.  For clarity, the bars are exaggerated to the scale in (b), which shows means, 5th, 25th, 75th and 95th percentiles of the observed annual decomposition magnitudes for each term.}
\label{fig:Snoob}
\end{center}
\end{figure}

Displaying each of the RTDICE magnitudes and directions graphically over time (Figure 1a) and in summary (Figure 1b) tells us immediately which of the decomposition terms played the largest role in driving the observed cultural trend.  For nearly three centuries, RS and mortality have consistently positive demographic effects on Snoobism, while parent-offspring transmission bias is small and apparently nondirectional.  Note that from the RTDICE decomposition itself we cannot tell if this RS effect results from differences in birth spacing, length of reproductive career, success in acquiring mates, or some combination of these.  Whatever the case, though, it is clear that on average Snoobs have more children than non-Snoobs, and that this is the most important trend in the evolution of Snoobism in the population over time.  

The strong, consistently positive effects from RS and mortality are not obvious from the frequency line itself, which for a full century shows little change in the prevalence of Snoobism in the population.  The decomposition terms indicate the reason: despite the fact the average Snoob has more children and is less likely to die than a non-Snoob, many more individuals abandon Snoobism than adopt it, maintaining Snoob frequency at around 20-25\%.  Only once this effect begins to vanish, 100 years after the settlement's founding, does Snoobism increase in frequency, and the last 15 census records all indicate a positive conversion balance that rivals the RS and mortality effects and facilitates Snoobism's eventual dominance.  

As with differential fertility and mortality, this reversal is consistent with many hypotheses. For example, it could be that an environmental or social change occurred some time between the years 130 and 180, after which Snoobism appeared to be an inherently more attractive lifestyle. Perhaps Snoobs developed a new institution for promoting conversion or preventing apostasy, or became politically dominant over non-Snoobs.  The trend is also consistent with a social learning hypothesis. Suppose, for example, that individuals tend to conform to the beliefs of the majority; then we would expect the conversion balance to covary with $\overline{\phi}$.  In our view, evolutionary decomposition is most valuable because such revealed trends can motivate targeted statistical modeling, which in turn can make predictions about future change.  

From the decomposition figures, we can also clearly see which processes \textit{don't} have large impact on the evolutionary trajectory. If we were measuring traits that are mostly transmitted horizontally within cohorts, such as musical preferences or use of a new technology, we expect to see a large transmission bias between parents and children.  This will also occur when measuring a life history characteristic like body weight or hunting skill, and as we discuss later this may even motivate a more sophisticated decomposition equation. The small bars of the transmission bias term in Figure 1 show that this is not true for one's Snoob status - children, when first censused, reliably hold the traits of their parents, Snoob or non-Snoob.

It should be noted that the apparent lack of a strong transmission bias does not render the process of character transmission unimportant. The fact that offspring tend to resemble their parents on average suggests that the Snoob trait is somehow heritable, and this heritability allows differential fertility and survival to affect the population mean. Still, Figure \ref{fig:Snoob} clearly shows that transmission bias in and of itself appears to have little direct effect on the rise of Snoobism, while the mechanisms behind RS, mortality and individual change all play determining roles.  


\section{Comparing Mechanisms of Cultural Change}

With decomposed trends now available, researchers can make informed forecasts about future change, compare parallel trends for other traits or in other populations, or design more specific goals for new rounds of data collection.  The most useful next step, in our opinion, is generating hypotheses about why these decomposition terms appear as they do, and developing and testing models of the mechanisms underlying these patterns.

For demonstration, we will focus here on the individual change term, with similar analyses of RS and mortality in the ESM.  Among those individuals who appear in multiple censuses, we wish to know what effectively predicts their Snoob status, 0 or 1, at time $t+1$ given the information available at time $t$.  If we consider an individual $i$'s Snoob status in the next census, $\phi_{i,t+1}$, as a binomial random variable, possible mechanisms can be formalized as  conditional probabilities of becoming a Snoob.  To be precise, we will assume individuals retain their current Snoob status with probability $(1-L)$ and update with probability $L$, and using some learning rule $M$.  Then each model takes the form $\Pr(\phi_{i,t+1}=1) = LM + (1-L)\phi_{i,t}$.  As discussed above, the three-century-long swing in direction of the individual change term seems to point to several different, mutually-inclusive mechanisms: 

\textit{Conformist social learning.}  Under this mechanism, individuals tend to abandon Snoobism when it is unpopular, but become Snoobs when it is common.  Beginning with Boyd and Richerson's 1985 model, the conformist learning bias can be expressed in the form $M = \overline{\phi}_t + 2(\beta-1)(2\overline{\phi}_t - 1)\overline{\phi}_t(1-\overline{\phi}_t)$. Parameter $\beta$ represents the strength of conformity; when it is 1, updating is frequency-dependent but unbiased, and when it is greater than 1, updating is biased towards conformity.  More general, but more complicated, versions of this equation have been developed, allowing the conformity threshold to vary from a simple majority \citep{bowles2006microeconomics} and the strength of conformity to vary without bound \citep{mcelreath2008beyond}. 
 
\textit{Individual learning/density dependence.}  As the population is steadily growing in the simulator, the observed swing in the individual change term is also consistent with a simple density-dependence.  Under such a mechanism, the probability of becoming or remaining a Snoob increases with the island's population size, perhaps because non-confrontational Snoob norms are more attractive in crowded environments.  Thus, for population size $N_t$, the updating model may be written as $M=\mathrm{logit}^{-1}(\alpha + \beta N_t)$.  

\textit{Individual learning/environmental change.}  It is also plausible that individuals adopt or maintain Snoobism purely as a consequence of ``environmental'' decision-making, regardless of current population size or Snoob prevalence. Shocks due to technological ratcheting or climatological shifts may make Snoobism, with its thrifty norms and informal channels of social support, a more appealing lifestyle.  The observed swing in the individual change term, then, may be consequent from a changing material environment alone.  Absent any form of economic or ecological data, we can still model this using simple time series models, e.g. $M=\mathrm{logit}^{-1}(\alpha + \beta t)$, which can account for unobserved environmental shifts. 

Of course, in real populations such processes are probably all in effect to varying degrees, so more complex updating models that incorporate mixtures of these simple mechanisms should be included as well.  Using information-theoretic model comparison techniques, we fit a variety of such models, simple and complex, to the individual-level phenotypic data using maximum likelihood, and compared them using the Akaike Information Criterion and Schwartz Criterion (also called BIC).  Table \ref{tab:Learning} shows the four best-performing models, all conformist learning models.  The dominance of such models is most consistent with a pure conformist social learning hypothesis, at least among the few hypotheses tested above.\footnote{Unsurprisingly, this was the learning model used by the agents in \texttt{SnoobSim}.}  The two other major drivers of Snoobism, RS and mortality, were analyzed in a similar fashion in the ESM.  Motivated by patterns in the decomposition terms, hypotheses about driving mechanisms of cultural evolution can be drawn from the rich theoretical literature and, using these methods, fitted to realistic field data.

\begin{table}[htbp]
  \centering
    \begin{footnotesize}
    \begin{tabular}{lcccl}
    Updating Model, $M$ & Conformity Coefficient & AIC$_c$ Weight & BIC Weight & Source \\
\hline
\hline
    $\overline{\phi}_t + 2(\beta-1)(2\overline{\phi}_t - 1)\overline{\phi}_t(1-\overline{\phi}_t)$ & 1.366 (1.322, 1.409) & 0.4049 & 0.5010 & Boyd and Richerson, 1985 \\
    $\overline{\phi}_t^{\beta} / (\overline{\phi}_t^{\beta} + (1-\overline{\phi}_t)^{\beta})$ & 1.374 (1.318, 1.429) & 0.4019 & 0.4972 & McElreath, et al., 2008 \\
    $\overline{\phi}_t + 2(\beta-1)(2\overline{\phi}_t - 2k)\overline{\phi}_t(1-\overline{\phi}_t)$ & 1.360 (1.311, 1.408) & 0.1743 & 0.0017 & Bowles, 2004 \\
    $\mathrm{logit}^{-1}(\alpha + \beta \overline{\phi}_t)$ & 6.389 (6.121, 6.658) & 0.0106 & 0.0001 & \\
    \hline
    \end{tabular}%
    \caption{Top four models among the thirteen fitted to the simulated census data, as measured by AIC$_c$ and BIC score (see ESM for full model list).  Each model $M$ of the thirteen is embedded in the equation $p=L(M) + (1-L)(\phi_{i,t})$, where $p$ describes the conditional probability an individual will be a Snoob in the next census, per $\phi_{i, t+1} \sim \mathrm{Binomial}(1, p)$.  The top four are all social learning models, each with a conformity coefficient $\beta$ of comparable meaning.} 
    \label{tab:Learning}
    \end{footnotesize}

\end{table}


\section{Discussion}

It is important to emphasize what the preceding evolutionary decomposition analysis gives us compared to standard demographic metrics. Birth and death rates could be more precisely compared using the total fertility rate, life expectancy at birth, or other common demographic measures. But by themselves these tools lack a direct mathematical connection to change in mean phenotype in the population, the most common way we measure evolution.  As a result, it is difficult to assess exactly how much mortality affects the population distribution of phenotype, versus RS, immigration, and so forth.  

These answers are readily available from decomposition of mean phenotypic change, regardless of the particularities of the system.  Phenotypes may be discrete values like Snoob status, or continuous, like body weight.  Because the decomposition equation is derived from basic facts about the population and data structure, its value depends not in the realism of its assumptions (which we contend are nearer to axioms), but rather in the meanings we can find in its terms, once strictly defined.  In doing so, three important qualifications must be stressed. 

First, the terms in the decomposition equation segregate but do not correspond exactly to evolutionary processes like sexual selection or biased social learning.  Snoobs may enjoy higher RS because of something inherent in practicing Snoobism, because the trait co-occurs with some other trait like income or age, or simply due to chance. The decomposition terms, most of which are covariances between phenotype and demographic outcomes, are really nothing more that dimensionalized correlations.  Following \cite{rice2004evolutionary} and \cite{henrich2008five}, we feel that terms like ``selection'' or ``fitness'' should only be invoked when a \textit{causal} pathway between phenotype and outcome can be supported, and even then any empirical decomposition term will be a combination of both causal and noncausal associations. 

Second, the RTDICE decomposition is only one possible partitioning of the observed phenotypic trajectory, and potentially not a very useful one.  For example, the differential mortality between Snoobs and non-Snoobs is partially a consequence of the fact Snoobs tend to be younger, which is a consequence of their differential RS.  We can use logistic models of mortality to establish that Snoob status predicts mortality outcomes even among those of the same age (see ESM), but the RTDICE mortality term cannot isolate this effect from the covariance between Snoobism and age.  If we expect structuring variables like age, gender, ethnic group, or location in a metapopulation will play an important role in the evolution of a particular phenotypic character, we should build this directly into the decomposition equation as appropriate for the dataset and the situation \citep{coulson2008dynamics}.  

We must also modify the equation if the categories we place people within are inappropriate, e.g. the intercensus period spans multiple generations, parentage cannot be identified, or we wish to distinguish immigrants from different sources.  Note that we need no special consideration of whether the parent of record is a genetic parent, and if appropriate we may specify other inheritance relationships like ``teacher'' or ``older sibling''; the evolutionary consequences of the observed relationship are an empirical matter.

The third qualification is that, without records of each demographic event as it happened, the terms in a decomposition equation should not be viewed as strictly independent.  The effects of intercensus events are inferred from comparing the two census records, but some information is necessarily lost, such as individual change shortly before death or after birth. 

In fact, if the population experiences demographic events in discrete seasons, the terms can lose their distinctiveness altogether.  Imagine, for example, a population of individuals experience heavy mortality in each winter, selecting out individuals with smaller phenotypes (e.g. weight, beak length).  Then, in the summer, the survivors give birth.  Applying RTDICE to annual census records would show a strong covariance between RS and phenotype even if phenotype plays no important role in mating or reproducing, simply because of the preceeding mortality event.  

We suspect that for large populations in which such demographic events do not follow a strict order, the distortions are minimal.  We can never properly rid ourselves of the problem of order, however, since every death removes the possibility of another birth, emigration event, etc.  For populations which do go through a distinct schedule of demographic events, one possible solution is to construct ordered-event decomposition equations.  

As in \cite{coulson2008dynamics}, the RTDICE equation only holds exactly for full census data without error. We realize that probably no dataset of the size and quality comparable to that simulated here exists in reality; real datasets nearly always contain just a sample of the full population and some amount of measurement error. Under circumstances of incomplete data, the terms of the RTDICE equation cannot simply be computed but must instead be estimated by statistical analysis. We anticipate that future research will elucidate the best statistical methods for estimating these terms.

Despite these limitations, we foresee a wide variety of applications for the decomposition approach in both evolutionary theory and studying human history.  The decomposition method provides unique advantages in profiling trends, motivating and testing hypotheses, and assisting prediction.  By applying basic demographic bookkeeping to high-resolution records of cultural change over time, we are also able to demonstrate conclusively the Darwinian nature of cultural transmission.

\bibliographystyle{apalike}
\bibliography{references}

\end{document}

